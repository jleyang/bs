(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8cf922f6"],{ab10:function(t,a,e){},f7da:function(t,a,e){"use strict";e("ab10")},fcd1:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t._self._c;return a("div",{staticClass:"index"},[a("user-selecter",{ref:"userSelecter",on:{change:t.userSelectChange}}),a("van-cell-group",{staticStyle:{"margin-top":"10px"},attrs:{inset:""}},[t.reload?a("van-calendar",{directives:[{name:"touch",rawName:"v-touch:swipe",value:t.swipeHandler,expression:"swipeHandler",arg:"swipe"}],staticClass:"calendar",attrs:{poppable:!1,"show-title":!1,"show-confirm":!1,"min-date":t.minDate,"max-date":t.maxDate,formatter:t.formatter,"default-date":t.defaultDate,color:"#1989fa"},on:{select:t.dayChange}}):t._e()],1),a("van-cell-group",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"},attrs:{inset:""}},[t.dayLogs.length>0?a("van-steps",{staticClass:"timeline",attrs:{direction:"vertical"}},[a("van-step"),a("van-step",[a("h3",[a("span",[t._v("上午 "+t._s(t.dayjs(1e3*t.dayLogs[0].daka_time).format("HH:mm")))]),2===t.dayLogs[0].daka_result?a("van-tag",{attrs:{type:"warning"}},[t._v("迟到")]):t._e(),5===t.dayLogs[0].daka_result?a("van-tag",{attrs:{type:"danger"}},[t._v("缺卡")]):t._e()],1),a("p",[t._v("考勤时间: "+t._s(t.dayjs(1e3*t.dayLogs[0].kaoqin_time).format("HH:mm")))])]),t.dayLogs.length>2?a("van-step",[a("h3",[a("span",[t._v("下午 "+t._s(t.dayjs(1e3*t.dayLogs[2].daka_time).format("HH:mm")))]),2===t.dayLogs[2].daka_result?a("van-tag",{attrs:{type:"warning"}},[t._v("迟到")]):t._e(),5===t.dayLogs[2].daka_result?a("van-tag",{attrs:{type:"danger"}},[t._v("缺卡")]):t._e()],1),a("p",[t._v("考勤时间: "+t._s(t.dayjs(1e3*t.dayLogs[2].kaoqin_time).format("HH:mm")))])]):t._e()],1):t._e()],1)],1)},n=[],i=e("5a0c"),r=e.n(i),o=e("9ef5"),d=e("b775");function m(t){return new Promise(a=>{t.page=0,Object(d["a"])({url:"kqdakatimebaobiao",method:"POST",data:t}).then(t=>{a(t.data)})})}var h={name:"Statistics",components:{UserSelecter:o["a"]},data(){return{dayjs:r.a,minDate:r()().startOf("month").toDate(),maxDate:r()().endOf("month").toDate(),signReport:[],dayLogs:[],reload:!0,userInfo:{},defaultDate:null}},methods:{swipeHandler(t){"left"===t?this.changeMonth(1):"right"===t&&this.changeMonth(-1)},changeMonth(t){0!==t&&(t<0?(t=Math.abs(t),this.minDate=r()(this.minDate).subtract(t,"month").startOf("month").toDate(),this.maxDate=r()(this.maxDate).subtract(t,"month").endOf("month").toDate()):(this.minDate=r()(this.minDate).add(t,"month").startOf("month").toDate(),this.maxDate=r()(this.maxDate).add(t,"month").endOf("month").toDate()),this.dayLogs=[],this.getSignReport({start_time:r()(this.minDate).startOf("month").unix(),end_time:r()(this.maxDate).endOf("month").unix()}),this.reload=!1,this.$nextTick(()=>{this.reload=!0}))},formatter(t){const a=r()(t.date).format("YYYY-MM-DD"),e=this.signReport.filter(t=>{const e=r()(1e3*t.kaoqin_time).format("YYYY-MM-DD");return e===a}),s=e.filter(t=>1===t.daka_result);return 0===e.length?(t.className="day-rest",t):s.length>=2?(t.className="day-succ",t):s.length<2?(t.className="day-miss",t):void 0},dayChange(t){const a=r()(t).format("YYYY-MM-DD"),e=this.signReport.filter(t=>{const e=r()(1e3*t.kaoqin_time).format("YYYY-MM-DD");return e===a});this.dayLogs=e},getSignReport({start_time:t,end_time:a}){return new Promise((e,s)=>{this.loading=!0,m({organ_id:this.userInfo.organ_id,name:this.userInfo.username,start_time:t,end_time:a}).then(a=>{this.signReport=this.signReport.concat(a.list),this.signReport=this.signReport.filter((t,a,e)=>e.findIndex(a=>a.kaoqin_time===t.kaoqin_time)===a),r()(1e3*t).format("YYYY-MM")===r()().format("YYYY-MM")?this.defaultDate=new Date:this.defaultDate=r()(1e3*t).toDate(),this.dayChange(this.defaultDate),this.loading=!1,e(a)}).catch(t=>{s(t)})})},userSelectChange(t){this.userInfo=t,this.dayLogs=[],this.signReport=[],this.getSignReport({start_time:r()(this.minDate).unix(),end_time:r()(this.maxDate).unix()})}}},l=h,g=(e("f7da"),e("2877")),c=Object(g["a"])(l,s,n,!1,null,"3f7df56d",null);a["default"]=c.exports}}]);
//# sourceMappingURL=chunk-8cf922f6.eb4dab29.js.map